# セキュリティ運用メモ

主に監査ログのローテーション設定と運用の注意点をまとめています。

## アクセスログローテーション
セキュリティイベントは `logs/security_access.jsonl` に JSONL 形式で書き出し、既定で **5 MB × 5 世代**（約 25 MB）保持します。調整したい場合は `.env` に以下を設定してください。

| 環境変数 | 役割 | 既定 | 例 |
| --- | --- | --- | --- |
| `ACCESS_LOG_ROTATION_SIZE_MB` | 1 ファイルの最大サイズ (MB) | `5.0` | `10` で 10 MB ごとにローテーション |
| `ACCESS_LOG_ROTATION_BACKUPS` | 保持世代数 | `5` | `14` で 2 週間分を保存 |

変更後は `uv run pytest tests/unit/test_security.py -q` を実行し、Bot を再起動して反映させてください。サイズを小さくすればディスク節約になりますが、監査期間も短くなります。

## 運用ヒント
- コンテナ運用では集中ログ基盤への転送を併用し、ローカル側は短期ローテーションで十分にする。
- ログには機密が含まれる可能性があるため、バックアップ対象から除外し、閲覧権限を限定する。

ローテーション以外のセキュリティ項目を追加する場合はこのノートに追記してください。
